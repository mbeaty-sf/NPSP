- option: one
  default: 1  # Don't really generate 1000 in a single execution

- option: thousand
  default: 10   # Don't really generate thousands in a single execution

- object: Contact
  count: 1300
  fields:
    RecordType: HH_Account
    FirstName: Contact <<id>> - 1
    LastName: Contact
    AccountId:
    - object: Account
      fields:
        Name: Account <<id>> - 1

- macro: OpportunityStuff
  fields:
    Name: Opportunity <<count>>
    AccountId: <<((count-1) % Account.id)+1>>
    Amount:
      random_number:
        min: 1
        max: 500

    CloseDate:
      random_choice:
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-01-01
                end_date: 2019-01-31
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-02-01
                end_date: 2019-02-28
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-03-01
                end_date: 2019-03-31
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-04-01
                end_date: 2019-04-30
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-05-01
                end_date: 2019-05-31
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-06-01
                end_date: 2019-06-30
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-07-01
                end_date: 2019-07-31
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-08-01
                end_date: 2019-08-31
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-09-01
                end_date: 2019-09-30
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-10-01
                end_date: 2019-10-31
        - choice:
            probability: <<550 * one>>
            pick:
              date_between:
                start_date: 2019-11-01
                end_date: 2019-11-30
        - choice:
            probability: <<7.5 * thousand>>
            pick:
              date_between:
                start_date: 2019-12-01
                end_date: 2019-12-31

        - choice:
            probability: <<14 * thousand>>
            pick:
              date_between:
                start_date: 2018-01-01
                end_date: 2018-12-31

        - choice:
            probability: <<14 * thousand>>
            pick:
              date_between:
                start_date: 2017-01-01
                end_date: 2017-12-31

        - choice:
            probability: <<14 * thousand>>
            pick:
              date_between:
                start_date: 2016-01-01
                end_date: 2016-12-31

        - choice:
            probability: <<14 * thousand>>
            pick:
              date_between:
                start_date: 2015-01-01
                end_date: 2015-12-31

        - choice:
            probability: <<7 * thousand>>
            pick:
              date_between:
                start_date: 2014-01-01
                end_date: 2014-12-31

    StageName:
      random_choice:
        - choice:
            probability: <<45 * thousand>>
            pick: Completed
        - choice:
            probability: <<(75 - 45) * thousand>>
            pick: Open

- object: npe03__Recurring_Donation__c
  count: << 1300 >>
  fields:
    Status__c: Active
    PaymentMethod__c:
          random_choice:
            - Credit Card
            - Check
    npe03__Schedule_Type__c: Multiply By
    RecurringType__c:
          random_choice:
            - choice:
                probability: 95%
                pick: Open
            - choice:
                probability: 5%
                pick: Fixed
    npe03__Installment_Period__c: Monthly
    npe03__Date_Established__c:
      date_between:
        start_date: 2016-08-01
        end_date: 2020-01-01
    npe03__Installments__c: << (date("2020-01-01") - date(npe03__Recurring_Donation__c.npe03__Date_Established__c)).days / 30 >>
    npe03__Amount__c:
      random_number:
        min: 1
        max: 100
    npe03__Contact__c: <<((count -1 )% Contact.id)+1>>  # pseudo-randomly select Account
  friends:
    - object: Opportunity
      include: OpportunityStuff
      count: <<npe03__Recurring_Donation__c.npe03__Installments__c>>
      fields:
        AccountId: <<npe03__Recurring_Donation__c.npe03__Organization__c>>
        CloseDate: << date(npe03__Recurring_Donation__c.npe03__Date_Established__c) + relativedelta(months=child_index) >>
        npe03__Recurring_Donation__c:
          reference:
            npe03__Recurring_Donation__c
        Amount: <<npe03__Recurring_Donation__c.npe03__Organization__c>>
      friends:
        - object: npe01__OppPayment__c
          fields:
            npe01__Opportunity__c:
              reference: Opportunity
